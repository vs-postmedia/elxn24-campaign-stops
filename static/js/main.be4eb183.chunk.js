(this["webpackJsonpelxn24-campaign-stops"]=this["webpackJsonpelxn24-campaign-stops"]||[]).push([[0],{104:function(t,e,a){t.exports=a.p+"static/media/Shift-BoldItalic.5c3edbfd.otf"},112:function(t){t.exports=JSON.parse('[{"id":0,"h2":"Campaign trails","text":"With party leaders often making a single in-person campaign stop each day due to COVID-19, where they choose to go could say a lot about party strategies. Here, we\u2019ve mapped every appearance made by the leaders. <p class=\'scroll-note\'>Scroll down</p>"},{"id":1,"text":"<strong class=\'horgan\'>John Horgan</strong> has focused on Metro ridings his NDP would like to flip. <strong class=\'wilkinson\'>Andrew Wilkinson</strong> has concentrated on Metro seats his Liberals need to keep."},{"id":2,"text":"Green leader <strong class=\'furstenau\'>Sonia Furstenau</strong> has focused her campaign around Victoria and her base in the Cowichan Valley, with trips to Vancouver, Squamish and Whistler."},{"id":3,"text":"Both <strong class=\'horgan\'>Horgan</strong> and <strong class=\'wilkinson\'>Wilkinson</strong> have traveled north to Kitimat and east to the Kootenays and the interior..."},{"id":4,"text":"... but these were some of\xa0their only stops outside of the vote-rich Lower Mainland."}]')},113:function(t,e){const a=window.innerWidth>400?[49.28218,-123.496327]:[49.58218,-123.596327],n=[{sliderValue:22,activeButton:"all",viewState:{bearing:-20,longitude:a[1],latitude:a[0],maxZoom:11,minZoom:4.5,pitch:60,transitionDuration:"auto",zoom:7}},{sliderValue:22,activeButton:"all",viewState:{bearing:.72,longitude:-123.0432730329727,latitude:49.1780540598552,maxZoom:11,minZoom:4.5,pitch:60,transitionDuration:"auto",zoom:9}},{sliderValue:22,activeButton:"furstenau",viewState:{bearing:9.8,longitude:-123.6166979586502,latitude:48.73956382851505,maxZoom:11,minZoom:4.5,pitch:50,transitionDuration:"auto",zoom:8.5}},{sliderValue:21,activeButton:"all",viewState:{bearing:-.35,longitude:-123.34935312214706,latitude:52.597241438637184,maxZoom:11,minZoom:4.5,pitch:60,transitionDuration:"auto",zoom:4.5}},{sliderValue:21,activeButton:"all",viewState:{bearing:-8.83,longitude:-122.964565510473,latitude:49.217462355344296,maxZoom:11,minZoom:4.5,pitch:60,transitionDuration:"auto",zoom:9}}];t.exports=n},131:function(t,e,a){t.exports=a(153)},136:function(t,e,a){},139:function(t,e,a){},141:function(t,e,a){},142:function(t,e,a){},143:function(t,e,a){},144:function(t,e,a){},145:function(t,e,a){},146:function(t,e,a){},147:function(t,e,a){},148:function(t,e,a){t.exports=a.p+"static/media/Shift-Bold.cdd38a86.otf"},149:function(t,e,a){t.exports=a.p+"static/media/BentonSansCond-Regular.43cd4ac7.otf"},150:function(t,e,a){t.exports=a.p+"static/media/BentonSansCond-RegItalic.69a4217c.otf"},151:function(t,e,a){t.exports=a.p+"static/media/BentonSansCond-Bold.6f6753fd.otf"},152:function(t,e,a){t.exports=a.p+"static/media/BentonSansCond-BoldItalic.a6640d89.otf"},153:function(t,e,a){"use strict";a.r(e);var n=a(1),i=a.n(n),o=a(106),s=a.n(o),r=a(107),l=a.n(r),c=a(161),d=(a(136),a(166)),u=a(162),p=a(114);a(139);class h extends n.Component{constructor(t){super(t),this.layers=[],this.hoverInfo={},this.state={data:[],hoverInfo:{}}}_viewChange(t){console.log(t)}_renderLayers(){const t=[];return this.props.data.forEach(e=>{t.push(new d.a({id:e.id,data:e.data,autoHighlight:!0,getHeight:.5,getSourcePosition:t=>[parseFloat(t.source_lon),parseFloat(t.source_lat)],getTargetPosition:t=>[parseFloat(t.target_lon),parseFloat(t.target_lat)],getSourceColor:e.color,getTargetColor:e.color,getWidth:4,pickable:!0,onHover:t=>{t.object?this.setState({hoverInfo:t}):this.setState({hoverInfo:{}})},updateTriggers:{data:[this.props.data]}}))}),t}renderTooltip(t){let e;const{object:a,x:n,y:o}=t;if(!a)return null;switch(a.candidate){case"Eby":e="#FD4E27";break;case"Furstenau":e="#009A44";break;case"Rustad":e="#08479A";break;default:e="#d1d2d4"}return i.a.createElement("div",{className:"popup",style:{cursor:"pointer",position:"absolute",zIndex:100,pointerEvents:"none",left:n+10,top:o}},i.a.createElement("h3",null,a.Date),i.a.createElement("p",null,i.a.createElement("strong",{style:{color:e}},a.candidate)," travels to ",a.city,", in the riding of ",i.a.createElement("strong",null,a.riding),". In 2020, the ",a.party_incumbent," won this riding by ",a.mov," points."))}render(){return i.a.createElement(u.a,{controller:{touchRotate:!0},initialViewState:this.props.viewState,layers:this._renderLayers(),pickingRadius:10},i.a.createElement(p.a,{mapboxApiAccessToken:this.props.accessToken,mapStyle:this.props.mapboxStyle}),this.renderTooltip(this.state.hoverInfo))}}var m=t=>{const e=t.articleView.viewState;return e.transitionInterpolator=new c.a,i.a.createElement(n.Fragment,null,i.a.createElement(h,{accessToken:t.accessToken,data:t.data,mapboxStyle:t.mapboxStyle,viewState:e}))};a(140),a(111),a(141);a(142);n.Component;a(143);var g=t=>i.a.createElement("input",{className:"input-slider",type:"range",step:1,min:1,max:t.sliderMax,value:t.value,onChange:t.onChange});a(144);var f=t=>i.a.createElement("div",{className:"filter-buttons"},i.a.createElement("button",{onClick:t.onClick,className:"btn active",id:"all"},"All"),i.a.createElement("button",{onClick:t.onClick,className:"btn",id:"furstenau"},"Green"),i.a.createElement("button",{onClick:t.onClick,className:"btn",id:"eby"},"NDP"),i.a.createElement("button",{onClick:t.onClick,className:"btn",id:"rustad"},"Conservative"));a(145);var v=t=>i.a.createElement("div",{className:"overlay-panel"},i.a.createElement("h2",{className:"date"},function(t){const e=new Date(t),a=["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."][e.getMonth()],n=e.getDate();return`${a} ${n}`}(t.currentDate)),i.a.createElement(g,{currentDate:t.date,sliderMax:t.sliderMax,value:t.sliderValue,onChange:t.onChange}),i.a.createElement(f,{onClick:t.onClick}));class w extends n.Component{constructor(t){super(t),this.dates=[],this.state={activeButton:"all",allData:[],currentDateIndex:0,currentView:this.props.articleViews[0],currentData:[],dataReady:!1,sliderMax:0,stepValue:0,timestamp:null},this.articleViews=this.props.articleViews,this.filterButton=this.filterButton.bind(this),this.updateGraphic=this.updateGraphic.bind(this),this.updateRouteData=this.updateRouteData.bind(this)}componentDidMount(){l.a.parse(this.props.dataUrl,{download:!0,header:!0,complete:t=>this.handleData(t.data)})}filterButton(t){let e;const a=t.target?t.target.id:t,n=this.state.timestamp;if(this.updateButtonClasses(a),"all"!==a){const t=this.state.allData.filter(t=>t.id===a);e=[{id:t[0].id,color:t[0].color,data:t[0].data.filter(t=>t.timestamp<=n)}]}else e=this.state.allData.map(t=>({id:t.id,color:t.color,data:t.data.filter(t=>t.timestamp<=n)}));this.setState({currentData:e,activeButton:a})}getTimestamp(t){return new Date(t)}handleData(t){const e=t.map(t=>(t.timestamp=new Date(t.date).getTime(),t)).sort((t,e)=>new Date(t.date).getTime()-new Date(e.timestamp).getTime());this.dates=[...new Set(e.filter(t=>""!==t.target_id).map(t=>t.date))];const a=[{id:"furstenau",color:[0,154,68,255],data:e.filter(t=>"Furstenau"===t.candidate&&""!==t.target_id)},{id:"eby",color:[253,78,39,255],data:e.filter(t=>"Eby"===t.candidate&&""!==t.target_id)},{id:"rustad",color:[8,71,154,255],data:e.filter(t=>"Rustad"===t.candidate&&""!==t.target_id)}];console.log(a);const n=this.dates[0];this.articleViews.forEach(t=>t.sliderValue=this.dates.length),this.setState({allData:a,currentData:a,currentDate:n,currentDateIndex:1,dataReady:!0,sliderMax:this.dates.length,timestamp:this.getTimestamp(n)})}updateButtonClasses(t){document.querySelectorAll(".btn").forEach(e=>{e.id===t?e.className="btn active":e.className="btn"})}updateGraphic(t){console.log(t);const e=this.articleViews[t.index].activeButton;this.setState({activeButton:e,currentView:this.articleViews[t.index],stepValue:t.index}),this.filterButton(e),this.updateRouteData(this.articleViews[t.index].sliderValue)}updateRouteData(t){let e;const a=t.target?t.target.valueAsNumber:t,n=this.dates[a-1],i=this.state.activeButton,o=this.getTimestamp(n);e="all"===i?this.state.allData:this.state.allData.filter(t=>t.id===i);const s=e.map(t=>({id:t.id,color:t.color,data:t.data.filter(t=>t.timestamp<=o)}));this.setState({currentDate:n,currentDateIndex:a,currentData:s,timestamp:o})}render(){return i.a.createElement(n.Fragment,null,i.a.createElement(v,{onClick:this.filterButton,currentDate:this.state.currentDate,sliderMax:this.state.sliderMax,sliderValue:this.state.currentDateIndex,onChange:this.updateRouteData}),i.a.createElement("div",{id:"deckgl-map"},i.a.createElement(m,{accessToken:this.props.accessToken,mapboxStyle:this.props.mapboxStyle,articleView:this.state.currentView,currentDate:this.state.currentDate,currentDateIndex:this.state.currentDateIndex,allData:this.state.allData,data:this.state.currentData,filterButton:this.filterButton,sliderMax:this.state.sliderMax,stepValue:this.state.stepValue,updateRouteData:this.updateRouteData})))}}var D="pk.eyJ1IjoibmpncmlmZml0aHMiLCJhIjoiY2o2Z3IwNDkwMGJ2OTJ4cG1rODE5ZzAyayJ9.VUOHF-DfNuiZTr9tRhH-jQ",x=a(112),b=a(113),y=a.n(b);a(146);var k=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(w,{articleEntries:x,articleViews:y.a,dataUrl:"https://vs-postmedia-data.sfo2.digitaloceanspaces.com/elxn/elxn2024/campaign-stops-2024.csv",mapboxStyle:"mapbox://styles/mapbox/outdoors-v11",accessToken:D}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(147),a(148),a(104),a(149),a(150),a(151),a(152);s.a.render(i.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(t=>{t.unregister()})}},[[131,1,2]]]);
//# sourceMappingURL=main.be4eb183.chunk.js.map