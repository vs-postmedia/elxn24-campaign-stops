(this["webpackJsonpelxn24-campaign-stops"]=this["webpackJsonpelxn24-campaign-stops"]||[]).push([[0],{104:function(t,e,a){t.exports=a.p+"static/media/Shift-BoldItalic.5c3edbfd.otf"},112:function(t){t.exports=JSON.parse('[{"id":0,"h2":"On the Campaign trail","text":"With a week to go before the 2024 election, where have party leaders been campaigning? What does it say about their plans? Postmedia has mapped party leaders\u2019 official campaign stops. <p class=\'scroll-note\'>Scroll down</p>"},{"id":1,"text":"Premier <strong class=\'ndp\'>David Eby\u2019s</strong> focus so far has been Vancouver Island and the Lower Mainland. He\u2019s also made trips to Vernon, Terrace, Castlegar and Grand Forks."},{"id":2,"text":"Conservative leader <strong class=\'cons\'>John Rustad</strong> has paid a lot of attention to the Lower Mainland and nearby regions. He\u2019s also been to Prince George, Kelowna and towns in southeastern B.C."},{"id":3,"text":"The Green Party\u2019s <strong class=\'green\'>Sonia Furstenau</strong> has only made a handful of trips outside of the Victoria\u2013Beacon Hill riding where she\u2019s looking to win a seat. The Green Party leader is currently an MPP in the riding of Cowichan Valley"},{"id":4,"text":"... but these were some of\xa0their only stops outside of the vote-rich Lower Mainland."}]')},113:function(t,e){const a=window.innerWidth>400?[49.28218,-123.296327]:[49.58218,-123.596327],n=[{sliderValue:22,activeButton:"all",viewState:{bearing:-0,longitude:a[1],latitude:a[0],maxZoom:11,minZoom:4.5,pitch:60,transitionDuration:"auto",zoom:7}},{sliderValue:22,activeButton:"eby",viewState:{bearing:.72,longitude:-123.0432730329727,latitude:49.1780540598552,maxZoom:11,minZoom:4.5,pitch:60,transitionDuration:"auto",zoom:6}},{sliderValue:22,activeButton:"rustad",viewState:{bearing:.72,longitude:-122.5432730329727,latitude:49.1780540598552,maxZoom:11,minZoom:4.5,pitch:60,transitionDuration:"auto",zoom:7}},{sliderValue:21,activeButton:"furstenau",viewState:{bearing:9.8,longitude:-123.34955971734388,latitude:48.44066017223553,maxZoom:15,minZoom:4.5,pitch:50,transitionDuration:"auto",zoom:12}},{sliderValue:21,activeButton:"all",viewState:{bearing:-8.83,longitude:-122.364565510473,latitude:49.217462355344296,maxZoom:11,minZoom:4.5,pitch:60,transitionDuration:"auto",zoom:6}}];t.exports=n},131:function(t,e,a){t.exports=a(153)},136:function(t,e,a){},139:function(t,e,a){},141:function(t,e,a){},142:function(t,e,a){},143:function(t,e,a){},144:function(t,e,a){},145:function(t,e,a){},146:function(t,e,a){},147:function(t,e,a){},148:function(t,e,a){t.exports=a.p+"static/media/Shift-Bold.cdd38a86.otf"},149:function(t,e,a){t.exports=a.p+"static/media/BentonSansCond-Regular.43cd4ac7.otf"},150:function(t,e,a){t.exports=a.p+"static/media/BentonSansCond-RegItalic.69a4217c.otf"},151:function(t,e,a){t.exports=a.p+"static/media/BentonSansCond-Bold.6f6753fd.otf"},152:function(t,e,a){t.exports=a.p+"static/media/BentonSansCond-BoldItalic.a6640d89.otf"},153:function(t,e,a){"use strict";a.r(e);var n=a(1),i=a.n(n),s=a(106),o=a.n(s),r=a(107),l=a.n(r),c=a(161),d=(a(136),a(166)),u=a(162),p=a(114);a(139);class h extends n.Component{constructor(t){super(t),this.layers=[],this.hoverInfo={},this.state={data:[],hoverInfo:{}}}_viewChange(t){console.log(t)}_renderLayers(){const t=[];return this.props.data.forEach(e=>{t.push(new d.a({id:e.id,data:e.data,autoHighlight:!0,getHeight:.5,getSourcePosition:t=>[parseFloat(t.source_lon),parseFloat(t.source_lat)],getTargetPosition:t=>[parseFloat(t.target_lon),parseFloat(t.target_lat)],getSourceColor:e.color,getTargetColor:e.color,getWidth:4,pickable:!0,onHover:t=>{t.object?this.setState({hoverInfo:t}):this.setState({hoverInfo:{}})},updateTriggers:{data:[this.props.data]}}))}),t}renderTooltip(t){let e;const{object:a,x:n,y:s}=t;if(!a)return null;switch(a.candidate){case"Eby":e="#FD4E27";break;case"Furstenau":e="#009A44";break;case"Rustad":e="#08479A";break;default:e="#d1d2d4"}return i.a.createElement("div",{className:"popup",style:{cursor:"pointer",position:"absolute",zIndex:100,pointerEvents:"none",left:n+10,top:s}},i.a.createElement("h3",null,a.Date),i.a.createElement("p",null,i.a.createElement("strong",{style:{color:e}},a.candidate)," travels to ",a.city,", in the riding of ",i.a.createElement("strong",null,a.riding),". In 2020, the ",a.party_incumbent," won this riding by ",a.mov," points."))}render(){return i.a.createElement(u.a,{controller:{touchRotate:!0},initialViewState:this.props.viewState,layers:this._renderLayers(),pickingRadius:10},i.a.createElement(p.a,{mapboxApiAccessToken:this.props.accessToken,mapStyle:this.props.mapboxStyle}),this.renderTooltip(this.state.hoverInfo))}}var m=t=>{const e=t.articleView.viewState;return e.transitionInterpolator=new c.a,i.a.createElement(n.Fragment,null,i.a.createElement(h,{accessToken:t.accessToken,data:t.data,mapboxStyle:t.mapboxStyle,viewState:e}))},g=(a(140),a(111)),f=a.n(g);a(141);var v=t=>{let e;const a=t.data;return e=a.h2?i.a.createElement("h2",null,a.h2):null,i.a.createElement("li",{className:"step","data-index":a.id},i.a.createElement("div",{className:"card"},e,i.a.createElement("p",{dangerouslySetInnerHTML:{__html:a.text}})))};var w=t=>i.a.createElement("ul",null,t.articleEntries.map((e,a)=>i.a.createElement(v,{data:e,key:e.id,step:t.step})));a(142);class b extends n.Component{componentDidMount(){const t=f()();t.setup({offset:.66,step:".step"}).onStepEnter(t=>this.props.updateGraphic(t,this.props.articleViews)).onStepExit(t=>{this.togglePointerEvents(t.index)}),window.addEventListener("resize",t.resize)}togglePointerEvents(t){const e=document.getElementById("scroller");parseInt(t)===this.props.articleEntries.length-1?e.classList.add("no-pointer"):e.classList.remove("no-pointer")}render(){return i.a.createElement("article",{id:"scroller"},i.a.createElement(w,{step:this.props.stepValue,articleEntries:this.props.articleEntries}))}}var x=b;a(143);var D=t=>i.a.createElement("input",{className:"input-slider",type:"range",step:1,min:1,max:t.sliderMax,value:t.value,onChange:t.onChange});a(144);var E=t=>i.a.createElement("div",{className:"filter-buttons"},i.a.createElement("button",{onClick:t.onClick,className:"btn active",id:"all"},"All"),i.a.createElement("button",{onClick:t.onClick,className:"btn",id:"furstenau"},"Green"),i.a.createElement("button",{onClick:t.onClick,className:"btn",id:"eby"},"NDP"),i.a.createElement("button",{onClick:t.onClick,className:"btn",id:"rustad"},"Conservative"));a(145);var y=t=>i.a.createElement("div",{className:"overlay-panel"},i.a.createElement("h2",{className:"date"},function(t){const e=new Date(t),a=["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."][e.getMonth()],n=e.getDate();return`${a} ${n}`}(t.currentDate)),i.a.createElement(D,{currentDate:t.date,sliderMax:t.sliderMax,value:t.sliderValue,onChange:t.onChange}),i.a.createElement(E,{onClick:t.onClick}));class S extends n.Component{constructor(t){super(t),this.dates=[],this.state={activeButton:"all",allData:[],currentDateIndex:0,currentView:this.props.articleViews[0],currentData:[],dataReady:!1,sliderMax:0,stepValue:0,timestamp:null},this.articleViews=this.props.articleViews,this.filterButton=this.filterButton.bind(this),this.updateGraphic=this.updateGraphic.bind(this),this.updateRouteData=this.updateRouteData.bind(this)}componentDidMount(){l.a.parse(this.props.dataUrl,{download:!0,header:!0,complete:t=>this.handleData(t.data)})}filterButton(t){let e;const a=t.target?t.target.id:t,n=this.state.timestamp;if(console.log(a,n),this.updateButtonClasses(a),"all"!==a){console.log(this.state);const t=this.state.allData.filter(t=>t.id===a);console.log(t),e=[{id:t[0].id,color:t[0].color,data:t[0].data.filter(t=>t.timestamp<=n)}]}else e=this.state.allData.map(t=>({id:t.id,color:t.color,data:t.data.filter(t=>t.timestamp<=n)}));this.setState({currentData:e,activeButton:a})}getTimestamp(t){return new Date(t)}handleData(t){const e=t.filter(t=>t.source_lat.length>0).map(t=>(t.timestamp=new Date(t.date).getTime(),t)).sort((t,e)=>new Date(t.date).getTime()-new Date(e.timestamp).getTime());this.dates=[...new Set(e.filter(t=>""!==t.target_id).map(t=>t.date))];const a=[{id:"furstenau",color:[0,154,68,255],data:e.filter(t=>"Furstenau"===t.candidate&&""!==t.target_id)},{id:"eby",color:[253,78,39,255],data:e.filter(t=>"Eby"===t.candidate&&""!==t.target_id)},{id:"rustad",color:[8,71,154,255],data:e.filter(t=>"Rustad"===t.candidate&&""!==t.target_id)}];console.log(a);const n=this.dates[this.dates.length];this.articleViews.forEach(t=>t.sliderValue=this.dates.length),this.setState({allData:a,currentData:a,currentDate:n,currentDateIndex:this.dates.length,dataReady:!0,sliderMax:this.dates.length,timestamp:this.getTimestamp(n)})}updateButtonClasses(t){document.querySelectorAll(".btn").forEach(e=>{e.id===t?e.className="btn active":e.className="btn"})}updateGraphic(t){console.log(t);const e=this.articleViews[t.index].activeButton;this.setState({activeButton:e,currentView:this.articleViews[t.index],stepValue:t.index}),this.filterButton(e),this.updateRouteData(this.articleViews[t.index].sliderValue)}updateRouteData(t){let e;const a=t.target?t.target.valueAsNumber:t,n=this.dates[a-1],i=this.state.activeButton,s=this.getTimestamp(n);e="all"===i?this.state.allData:this.state.allData.filter(t=>t.id===i);const o=e.map(t=>({id:t.id,color:t.color,data:t.data.filter(t=>t.timestamp<=s)}));this.setState({currentDate:n,currentDateIndex:a,currentData:o,timestamp:s})}render(){return i.a.createElement(n.Fragment,null,i.a.createElement(y,{onClick:this.filterButton,currentDate:this.state.currentDate,sliderMax:this.state.sliderMax,sliderValue:this.state.currentDateIndex,onChange:this.updateRouteData}),i.a.createElement("div",{id:"deckgl-map"},i.a.createElement(m,{accessToken:this.props.accessToken,mapboxStyle:this.props.mapboxStyle,articleView:this.state.currentView,currentDate:this.state.currentDate,currentDateIndex:this.state.currentDateIndex,allData:this.state.allData,data:this.state.currentData,filterButton:this.filterButton,sliderMax:this.state.sliderMax,stepValue:this.state.stepValue,updateRouteData:this.updateRouteData})),this.state.dataReady&&i.a.createElement(x,{articleEntries:this.props.articleEntries,articleViews:this.props.articleViews,dataReady:this.state.dataReady,step:this.state.stepValue,updateGraphic:this.updateGraphic}))}}var V="pk.eyJ1IjoibmpncmlmZml0aHMiLCJhIjoiY2o2Z3IwNDkwMGJ2OTJ4cG1rODE5ZzAyayJ9.VUOHF-DfNuiZTr9tRhH-jQ",C=a(112),k=a(113),B=a.n(k);a(146);var I=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(S,{articleEntries:C,articleViews:B.a,dataUrl:"https://docs.google.com/spreadsheets/d/e/2PACX-1vStaVcZWeQ0TcDzgnwDBYwCgdFurRDwXzEWrbf_6I0v60WBuHbef-TuUh0dxTXiLfygV-74G4jhISaf/pub?gid=1101148911&single=true&output=csv",mapboxStyle:"mapbox://styles/mapbox/outdoors-v11",accessToken:V}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(147),a(148),a(104),a(149),a(150),a(151),a(152);o.a.render(i.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(t=>{t.unregister()})}},[[131,1,2]]]);
//# sourceMappingURL=main.b01cf42c.chunk.js.map